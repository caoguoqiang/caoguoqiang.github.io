<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Caoguoqiang.GitHub.io by caoguoqiang</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

</head>
<body>
<div id="header">
    <nav>
        <li class="fork"><a href="https://github.com/caoguoqiang">View On GitHub</a></li>
    </nav>
</div><!-- end header -->

<div class="wrapper">

    <section>
        <div id="title">
            <h1>Caoguoqiang.GitHub.io</h1>
            <p>曹国强的博客</p>
            <hr>
            <span class="credits left">Project maintained by <a
                    href="https://github.com/caoguoqiang">caoguoqiang</a></span>
            <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a
                    href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <p>在使用Android Studio 2.1时，想要使用lambda表达示。根据AS自带的提示需要增加了

            android {
            …….
            compileOptions {
            sourceCompatibility JavaVersion.VERSION_1_8
            targetCompatibility JavaVersion.VERSION_1_8
            }
            …….
            }

            问题：
            Error:Jack is required to support java 8 language features. Either enable Jack or remove sourceCompatibility JavaVersion.VERSION_1_8.

            解决：配置Gradle.
            在模块特定的 build.gradle 文件中输入以下内容：
            android {
            …….
            defaultConfig {

            jackOptions {
            enabled true
            }

            }
            compileOptions {
            sourceCompatibility JavaVersion.VERSION_1_8
            targetCompatibility JavaVersion.VERSION_1_8
            }
            …..这里写代码片
            }

            原因：AS新版本java8新特性需要jack工具链

            新的 Java 8 语言功能，还需使用新的 Jack 工具链。新的 Android 工具链将 Java 源语言编译成 Android 可读取的 Dalvik 可执行文件字节码，且有其自己的 .jack 库格式，在一个工具中提供了大多数工具链功能：重新打包、压缩、模糊化以及 Dalvik 可执行文件分包。

            以下是构建 Android Dalvik 可执行文件可用的两种工具链的对比：

            旧版 javac 工具链：
            javac (.java –> .class) –> dx (.class –> .dex)
            新版 Jack 工具链：
            Jack (.java –> .jack –> .dex)

            官方说明网址：https://developer.android.com/preview/j8-jack.html

            /********************************************************/

            更新：2016.5.31

            问题：Error:Could not find property ‘options’ on task ‘:app:compileDebugJavaWithJack’.

            原因：使用Jack时不能同时使用APT，暂时不兼容。包括butterknife，Dagger等使用了APT的注解框架。希望Google可以尽早解决。

            问题参考Google Code:https://code.google.com/p/android/issues/detail?id=203850

            方案二

            ：使用第三方Java8兼容插件。

            github:

            https://github.com/evant/gradle-retrolambda
            1.下载Java8
            2.把以下代码增加到 build.gradle

            buildscript {
            repositories {
            mavenCentral()
            }

            dependencies {
            classpath 'me.tatarka:gradle-retrolambda:3.2.5'
            }
            }

            // Required because retrolambda is on maven central
            repositories {
            mavenCentral()
            }

            apply plugin: 'com.android.application' //or apply plugin: 'java'
            apply plugin: 'me.tatarka.retrolambda'
            1
            2
            3
            4
            5
            6
            7
            8
            9
            10
            11
            12
            13
            14
            15
            16
            17
            3.使用Android Studio IDE,请在build.gradle文件上加入

            android {
            compileOptions {
            sourceCompatibility JavaVersion.VERSION_1_8
            targetCompatibility JavaVersion.VERSION_1_8
            }
            }</p>

    </section>

</div>
<!--[if !IE]>
<script>fixScale(document);</script><![endif]-->

</body>
</html>
