<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>Android 6.0 解决recyclerview 在 scrollview 中不能全部显示，高度不正常的问题。</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="g1r8" id="android-60-解决recyclerview-在-scrollview-中不能全部显示高度不正常的问题">Android 6.0 解决recyclerview 在 scrollview 中不能全部显示，高度不正常的问题。</h1><hr><p data-anchor-id="usb3"><a href="http://stackoverflow.com/questions/27083091/recyclerview-inside-scrollview-is-not-working" target="_blank">http://stackoverflow.com/questions/27083091/recyclerview-inside-scrollview-is-not-working</a></p><p data-anchor-id="fqra">主要代码</p><p data-anchor-id="kjqp"><a href="https://github.com/amardeshbd/android-recycler-view-wrap-content" target="_blank">https://github.com/amardeshbd/android-recycler-view-wrap-content</a></p><p data-anchor-id="g4zr">This is a sample android app which demonstrates <code>RecyclerView</code> wrap_content inside <code>ScrollView</code> issue on Marshmallow and Nougat (API 23 &amp; 24) and how to work around it.</p><p data-anchor-id="8f7u">在API23 24中不能正常工作。</p><p data-anchor-id="hcdf">解决办法：</p><p data-anchor-id="mgw3">在 recyclerview 外面再包一层 RelativeLayout</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0ash"><ol class="linenums"><li class="L0"><code class="language-android"><span class="pln">    </span><span class="tag">&lt;RelativeLayout</span></code></li><li class="L1"><code class="language-android"><span class="pln">            </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L2"><code class="language-android"><span class="pln">            </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L3"><code class="language-android"><span class="pln">            </span><span class="atn">android:descendantFocusability</span><span class="pun">=</span><span class="atv">"blocksDescendants"</span><span class="tag">&gt;</span></code></li><li class="L4"><code class="language-android"><span class="pln">            </span><span class="com">&lt;!-- DEV NOTE: Outer wrapper relative layout is added intentionally to address issue</span></code></li><li class="L5"><code class="language-android"><span class="com">                 that only happens on Marshmallow &amp; Nougat devices (API 23 &amp; 24).</span></code></li><li class="L6"><code class="language-android"><span class="com">                 On marshmallow API 23, the "RecyclerView" `layout_height="wrap_content"` does NOT</span></code></li><li class="L7"><code class="language-android"><span class="com">                 occupy the height of all the elements added to it via adapter. The result is cut out</span></code></li><li class="L8"><code class="language-android"><span class="com">                 items that is outside of device viewport when it loads initially.</span></code></li><li class="L9"><code class="language-android"><span class="com">                 Wrapping "RecyclerView" with "RelativeLayout" fixes the issue on Marshmallow devices.</span></code></li><li class="L0"><code class="language-android"><span class="com">            --&gt;</span></code></li><li class="L1"><code class="language-android"><span class="pln">            </span><span class="tag">&lt;android.support.v7.widget.RecyclerView</span></code></li><li class="L2"><code class="language-android"><span class="pln">                </span><span class="atn">android:id</span><span class="pun">=</span><span class="atv">"@+id/my_recycler_view"</span></code></li><li class="L3"><code class="language-android"><span class="pln">                </span><span class="atn">android:layout_width</span><span class="pun">=</span><span class="atv">"match_parent"</span></code></li><li class="L4"><code class="language-android"><span class="pln">                </span><span class="atn">android:layout_height</span><span class="pun">=</span><span class="atv">"wrap_content"</span></code></li><li class="L5"><code class="language-android"><span class="pln">                </span><span class="atn">tools:listitem</span><span class="pun">=</span><span class="atv">"@layout/row_list_item"</span><span class="tag">&gt;</span></code></li><li class="L6"><code class="language-android"></code></li><li class="L7"><code class="language-android"><span class="pln">            </span><span class="tag">&lt;/android.support.v7.widget.RecyclerView&gt;</span></code></li><li class="L8"><code class="language-android"></code></li><li class="L9"><code class="language-android"><span class="pln">    </span><span class="tag">&lt;/RelativeLayout&gt;</span></code></li></ol></pre><hr><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="77x1"><ol class="linenums"><li class="L0"><code class="language-android"><span class="pln"> mRecyclerView</span><span class="pun">.</span><span class="pln">setHasFixedSize</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span></code></li><li class="L1"><code class="language-android"></code></li><li class="L2"><code class="language-android"><span class="pln">    </span><span class="com">// use a linear layout manager</span></code></li><li class="L3"><code class="language-android"><span class="pln">    mLayoutManager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LinearLayoutManager</span><span class="pun">(</span><span class="pln">getContext</span><span class="pun">());</span></code></li><li class="L4"><code class="language-android"><span class="pln">    mLayoutManager</span><span class="pun">.</span><span class="pln">setOrientation</span><span class="pun">(</span><span class="typ">LinearLayoutManager</span><span class="pun">.</span><span class="pln">VERTICAL</span><span class="pun">);</span></code></li><li class="L5"><code class="language-android"><span class="pln">    mRecyclerView</span><span class="pun">.</span><span class="pln">setLayoutManager</span><span class="pun">(</span><span class="pln">mLayoutManager</span><span class="pun">);</span></code></li><li class="L6"><code class="language-android"></code></li><li class="L7"><code class="language-android"><span class="pln">    </span><span class="com">// Disabled nested scrolling since Parent scrollview will scroll the content.</span></code></li><li class="L8"><code class="language-android"><span class="pln">    mRecyclerView</span><span class="pun">.</span><span class="pln">setNestedScrollingEnabled</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span></code></li><li class="L9"><code class="language-android"></code></li><li class="L0"><code class="language-android"><span class="pln">    </span><span class="com">// specify an adapter (see also next example)</span></code></li><li class="L1"><code class="language-android"><span class="pln">    mAdapter </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SimpleListAdapter</span><span class="pun">(</span><span class="typ">DataSetProvider</span><span class="pun">.</span><span class="pln">generateDataset</span><span class="pun">());</span></code></li><li class="L2"><code class="language-android"><span class="pln">    mRecyclerView</span><span class="pun">.</span><span class="pln">setAdapter</span><span class="pun">(</span><span class="pln">mAdapter</span><span class="pun">);</span></code></li></ol></pre></div>
</body>
</html>